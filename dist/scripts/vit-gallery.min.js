!function(n){n.fn.vitGallery=function(t){function e(n){R=N.find("."+K.controlsClass),S=N.find(".gallery__block"),T=N.find(".prev"),M=N.find(".next"),D=N.find(".gallery__thumbnail").length>0?N.find(".gallery__thumbnail"):N.find(".gallery__controls__item"),H=N.find(".gallery__inner"),B=H.find(".gallery__img-block.current"),P=O.find(".gallery__description-block__description"),j=B.index()}function i(){B=H.find(".gallery__img-block.current"),j=B.index(),P=O.find(".gallery__description-block__description"),Q=n("."+Z).find(".current"),"thumbnails"==K.controls&&(E=parseInt(z.css("left")))}function a(){O.each(function(){n(this).find("span").addClass("gallery__description-block__description"),n(this).find("img").addClass("gallery__img-block__img")}),e()}function l(){O.wrapAll('<div class="gallery__block"><div class="'+U+'"></div></div>'),e()}function s(){var t=0;return K.imgPadding&&0!=K.imgPadding&&(t=(O.length-1)*K.imgPadding),O.each(function(){t+=n(this).outerWidth()}),e(),t}function r(){var n=N.find("."+U);n.css("width",s()),e()}function o(){O.css("width",N.width()),e("setImgBlockWidth")}function c(){O.each(function(){var t=n(this).find(".gallery__img-block__img");n(this).addClass("load"),t.bindImageLoad(function(){var t=n(this);setTimeout(function(){t.parent().removeClass("load"),t=null},100)})}),e("setGalleryHeight")}function d(){var t='<span class="prev"></span>',e='<span class="next"></span>',i='<div class="gallery__controls-buttons"></div>',a=S.append(n(i));a.find(".gallery__controls-buttons").append(n(t)).append(n(e))}function u(){var t=n("body"),e='<span class="'+nn+'"></span>',i='<div class="'+$+" fullscreen_"+N.attr("class")+'"></div>',a='<span class="'+tn+'"></span>',l='<div class="gallery__fake"></div>',s='<div class="gallery__fullscreen__controls"><span class="prev"></span><span class="next"></span></div>';S.append(e),N.append(i),F=t.find(".fullscreen_"+N.attr("class")).append(a),F.append(l),F.append(s);F.find("."+K.controlsClass).addClass("fullscreen")}function f(){var n=B.find("img").attr("src");F.append('<img src="'+n+'" class="gallery__fullscreen__img">')}function h(t,e){var i=F.find(".gallery__fullscreen__img");switch(t){case"next":var a=B.next().find("img").attr("src");i.attr("src",a);break;case"prev":var l=B.prev().find("img").attr("src");i.attr("src",l);break;case"goTo":var s=n(".gallery__img-block").eq(e).find("img").attr("src");i.attr("src",s)}}function m(){if(K.controls){R=N.find("."+K.controlsClass);for(var t='<li class="gallery__controls__item"></li>',i=0;O.length>i;i++)var a=R.append(t);n(".gallery__controls__item").each(function(t){n(this).addClass("item_"+t)}),R.append(a);n(a).find("li").wrapAll('<ul class="gallery__controls__ul"></ul>')}e("createControls")}function _(){var t,i='<div class="gallery__controls__inner"></div>',a='<div class="gallery__controls__thumbnails-ul"></div>';if(K.controls){R=N.find("."+K.controlsClass);var l=R.append(a);l.find(".gallery__controls__thumbnails-ul").append(i),G=l.find(".gallery__controls__thumbnails-ul"),z=n(".gallery__controls__inner"),O.each(function(){var e=n(this).find("img"),i=e.attr("thumb-url");t=document.createElement("img"),t.src=i,n(t).css("width","100%"),z.append(n(t))}),z.find("img").wrap('<span class="'+Y+'"></span>'),n("."+Y).width(K.thumnailWidth).height(K.thumnaiHeight).css("margin-right",K.thumbnailMargin).attr("data-index",n(this).index()).last().css("margin-right",0),n("."+Y).append("<i></i>"),z.css({width:(n("."+Y).outerWidth()+K.thumbnailMargin)*n("."+Y).length-K.thumbnailMargin,left:0}),e("createThumbnails")}}function p(){var t=G.outerWidth(),e=n(".gallery__thumbnail"),i=e.outerWidth(),a=Math.round(t/i)/2;a=Math.round(a),L=e.eq(a-1),L.addClass("center")}function g(){S.append('<div class="'+V+'"></div>'),P.each(function(){n("."+V).append(n(this))}),P.eq(j).addClass("current"),e("createDescription")}function v(n,t){P=N.find(".gallery__description-block__description"),P.eq(n).removeClass("current"),P.eq(t).addClass("current")}function y(){O.each(function(t){0!=t&&n(this).css("display","inline-block")}),e("showImg")}function b(t,e){switch(t){case"next":D.eq(e).find("i").css({left:"auto",width:"100%"}).animate({width:0},K.thumbnailAnimationSpeed,function(){n(this).css({left:"",width:""})}),D.eq(e+1).find("i").css({right:"auto",width:"0"}).animate({width:"100%"},K.thumbnailAnimationSpeed,function(){n(this).css({right:"",width:""})});break;case"prev":D.eq(e).find("i").css({right:"auto",width:"100%"}).animate({width:"0"},K.thumbnailAnimationSpeed,function(){n(this).css({right:"",width:""})}),D.eq(e-1).find("i").css({left:"auto",width:"0"}).animate({width:"100%"},K.thumbnailAnimationSpeed,function(){n(this).css({left:"",width:""})})}}function C(n){return B.is(":last-child")||("slide"==K.transition?(H.animate({left:X-O.width()},K.animateSpeed),X-=O.width()):"crossfade"==K.transition&&(B.animate({opacity:0},150),B.animate({opacity:1},150)),K.fullscreen&&h("next"),B.removeClass("current"),B.next().addClass("current"),D.eq(j).removeClass("current"),D.eq(j+1).addClass("current"),K.thumbnailAnimation&&b("next",j),K.autoplay&&(clearInterval(J),q()),v(j,j+1),i(),I(),n&&n(),x(j)),j}function w(n){if(!B.is(":first-child")){if("slide"==K.transition?(H.animate({left:X+O.width()},K.animateSpeed),X+=O.width()):"crossfade"==K.transition&&(B.animate({opacity:0},150),B.animate({opacity:1},150)),K.fullscreen&&h("prev"),B.removeClass("current"),B.prev().addClass("current"),D.eq(j).removeClass("current"),D.eq(j-1).addClass("current"),K.thumbnailAnimation&&b("prev",j),K.autoplay&&(clearInterval(J),q()),v(j,j-1),i(),I(),"thumbnails"==K.controls){G.offset().left,D.first().offset().left}n&&n(),x(j)}}function k(n){"slide"==K.transition?j<n?(H.animate({left:X-O.width()*(n-j)},K.animateSpeed),X-=O.width()*(n-j)):(H.animate({left:-(O.width()*(n+j)+X)},K.animateSpeed),X=-(O.width()*(n+j)+X)):"crossfade"==K.transition&&(H.find(".current").animate({opacity:0},150),H.find(".current").animate({opacity:1},150)),v(H.find(".current").index(),n),H.find(".current").removeClass("current"),O.eq(n).addClass("current"),K.thumbnailAnimation&&(R.find(".current").find("i").css({width:"",left:"",right:""}),j-n==-1?b("next",j):j-n==1&&b("prev",j)),R.find(".current").removeClass("current"),D.eq(n).addClass("current"),I(),i(),K.autoplay&&(clearInterval(J),q()),K.fullscreen&&h("goTo",H.find(".current").index()),x(j)}function x(n){D.length;n==D.length-1?N.find(".next").addClass("hide"):N.find(".next").removeClass("hide"),0==n?N.find(".prev").addClass("hide"):N.find(".prev").removeClass("hide")}function q(){var n=O.length;J=setInterval(function(){(j+1)/n==1&&(clearInterval(J),setTimeout(function(){k(0)},K.autoplayDelay/2)),C()},K.autoplayDelay)}function W(){X=parseInt(H.css("left")),j=B.index();var t=0;if(T.on("click",function(){n(this).hasClass("hide")||(t++,B=H.find(".gallery__img-block.current"),w())}),M.on("click",function(){n(this).hasClass("hide")||(B=H.find(".gallery__img-block.current"),C())}),D.on("click",function(){k(n(this).index())}),K.fullscreen){var e=N.find("."+nn),a=n(".fullscreen_"+N.attr("class")).find("."+tn);e.on("click",function(){F.addClass("open"),R.appendTo(F),"thumbnails"==K.controls&&(n(".gallery__thumbnail.center").removeClass("center"),p()),f()}),a.on("click",function(){F.removeClass("open"),R.appendTo(N),"thumbnails"==K.controls&&(n(".gallery__thumbnail.center").removeClass("center"),p()),I(),F.find(".gallery__fullscreen__img").remove()})}"thumbnails"==K.controls&&z.on("mousedown",function(t){var e,i=t.pageX,a=z.css("left");n(this).offset().left,n(this).offset().left+n(this).outerWidth();n(window).on("mousemove",function(n){var t=i-n.pageX,l=n.pageX;!function(){setTimeout(function(){e=n.pageX},50)}(),l>e&&z.css("left",parseInt(a)-t),l<e&&z.css("left",parseInt(a)-t),n.preventDefault()}).on("mouseup",function(t){t.preventDefault(),z.offset().left>=z.parent().offset().left&&(z.addClass("go-back").css("left",0),setTimeout(function(){z.removeClass("go-back")},300)),z.offset().left+z.outerWidth()<=z.parent().offset().left+z.parent().outerWidth()&&(z.addClass("go-back").css("left",z.parent().outerWidth()-z.outerWidth()),setTimeout(function(){z.removeClass("go-back")},300)),n(this).unbind("mousemove")}),t.preventDefault()}),n(window).on("resize",function(){K.autoplay&&clearInterval(J),c(),o(),r(),i(),H.css("left",-(j*B.width())),X=-(j*B.width()),K.autoplay&&q()})}function I(){var n=0;if(N.find(".current").length>0){if(n=N.find(".current").index(),"thumbnails"==K.controls){var t=D.eq(n).offset().left+(D.outerWidth()+K.thumbnailMargin)/2,a=L.offset().left+(D.outerWidth()+K.thumbnailMargin)/2;D.eq(n).index()>L.index()-1&&D.eq(n).index()<=D.length-L.index()-2&&z.animate({left:-(t-a)},300)}D.eq(n).addClass("current"),H.css("left",-(n*O.width()))}else O.first().addClass("current"),D.first().addClass("current");return e("getCurrentSlide"),i(),n}function A(){a(),l(),d(),c(),o(),r(),y(),"points"==K.controls?m():"thumbnails"==K.controls&&(_(),p()),K.fullscreen&&u(),I(),K.description&&g(),W(),K.autoplay&&q()}var S,T,M,D,H,P,X,B,j,G,L,Q,z,E,F,J,K=n.extend({debag:!1,galleryHeight:"auto",imgBlockClass:"gallery__img-block",controls:"thumbnails",controlsClass:"gallery__controls",thumnailWidth:90,thumnaiHeight:60,thumbnailMargin:5,thumbnailAnimation:!0,thumnailAnimationSpeed:1e3,animateSpeed:1e3,description:!0,imgPadding:15,autoplay:!1,autoplayDelay:3e3,fullscreen:!1,transition:"slide"},t),N=n(this),O=N.find("."+K.imgBlockClass),R=N.find("."+K.controlsClass),U="gallery__inner",V="gallery__description-block",Y="gallery__thumbnail",Z="gallery__controls",$="gallery__fullscreen__wrap",nn="gallery__fullscreen__bt",tn="gallery__fullscreen__exit";A()}}(jQuery),function(n){n.fn.bindImageLoad=function(t){function e(n){return!!n.complete&&("undefined"==typeof n.naturalWidth||0!==n.naturalWidth)}return this.each(function(){var i=n(this);i.is("img")&&n.isFunction(t)&&(i.one("load",t),e(this)&&i.trigger("load"))})}}(jQuery);